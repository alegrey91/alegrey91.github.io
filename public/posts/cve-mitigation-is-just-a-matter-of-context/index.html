<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>
  CVE mitigation is just a matter of context · Alessio Greggi&#39;s Blog
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Alessio Greggi">
<meta name="description" content="My last period at SUSE has been quite interesting. Last July, I moved to the SUSE Security team to help develop a new project for the security portfolio.
This project answer to the name of SBOMscanner, a SBOM-centric security scanner for registries, that has its lifecycle inside kubernetes.
One of the first features I&rsquo;ve made was about supporting VEX repositories configuration (link here). Thanks to this task I had the chance of discovering this new standard format used to convey information about the exploitability of vulnerabilities in software products and share it with scanning tools.">
<meta name="keywords" content="blog,developer,personal">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="CVE mitigation is just a matter of context">
  <meta name="twitter:description" content="My last period at SUSE has been quite interesting. Last July, I moved to the SUSE Security team to help develop a new project for the security portfolio.
This project answer to the name of SBOMscanner, a SBOM-centric security scanner for registries, that has its lifecycle inside kubernetes.
One of the first features I’ve made was about supporting VEX repositories configuration (link here). Thanks to this task I had the chance of discovering this new standard format used to convey information about the exploitability of vulnerabilities in software products and share it with scanning tools.">

<meta property="og:url" content="http://localhost:1313/posts/cve-mitigation-is-just-a-matter-of-context/">
  <meta property="og:site_name" content="Alessio Greggi&#39;s Blog">
  <meta property="og:title" content="CVE mitigation is just a matter of context">
  <meta property="og:description" content="My last period at SUSE has been quite interesting. Last July, I moved to the SUSE Security team to help develop a new project for the security portfolio.
This project answer to the name of SBOMscanner, a SBOM-centric security scanner for registries, that has its lifecycle inside kubernetes.
One of the first features I’ve made was about supporting VEX repositories configuration (link here). Thanks to this task I had the chance of discovering this new standard format used to convey information about the exploitability of vulnerabilities in software products and share it with scanning tools.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-18T15:42:47+01:00">
    <meta property="article:modified_time" content="2025-12-18T15:42:47+01:00">




<link rel="canonical" href="http://localhost:1313/posts/cve-mitigation-is-just-a-matter-of-context/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/img/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/">
      Alessio Greggi&#39;s Blog
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://localhost:1313/posts/cve-mitigation-is-just-a-matter-of-context/">
              CVE mitigation is just a matter of context
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2025-12-18T15:42:47&#43;01:00">
                December 18, 2025
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              4-minute read
            </span>
          </div>
          <div class="authors">
  <i class="fa-solid fa-user" aria-hidden="true"></i>
    <a href="/authors/alessio-greggi/">Alessio Greggi</a></div>

          
          
        </div>
      </header>

      <div class="post-content">
        
        <p>My last period at SUSE has been quite interesting. Last July, I moved to the SUSE Security team to help develop a new project for the security portfolio.</p>
<p>This project answer to the name of <a href="github.com/kubewarden/sbomscanner" >SBOMscanner</a>, a SBOM-centric security scanner for registries, that has its lifecycle inside kubernetes.</p>
<p>One of the first features I&rsquo;ve made was about supporting <a href="https://www.cisa.gov/sites/default/files/publications/VEX_Use_Cases_Document_508c.pdf"  class="external-link" target="_blank" rel="noopener">VEX</a> repositories configuration (link <a href="https://github.com/kubewarden/sbomscanner/pull/330"  class="external-link" target="_blank" rel="noopener">here</a>). Thanks to this task I had the chance of discovering this new standard format used to convey information about the exploitability of vulnerabilities in software products and share it with scanning tools.</p>
<p>Since there, I&rsquo;ve been thinking about the possibility of generating VEX documents in order to reduce the noise of vulnerabilities in a way that doesn&rsquo;t require an extensive knowledge about security concepts. This ended up with a nice idea that I&rsquo;m going to describe below.</p>
<h2 id="introduction">
  Introduction
  <a class="heading-link" href="#introduction">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>VEX is commonly used to suppress vulnerabilities that are not affecting your application. This is usually a task for security experts or highly seasoned software engineers that well known the code base they are working on. A common example of this is when you have a vulnerability in a library that you are importing in your project, but you perfectly know that the vulnerable code in the library is not reachable from your application. This import would not be considered exploitable, since the project is not making use of the piece of code in the library which has this vulnerability.</p>
<p>Considering that, VEX comes into help to instruct the scanning tools (such as <a href="https://github.com/aquasecurity/trivy"  class="external-link" target="_blank" rel="noopener">Trivy</a>) to skip the inclusion of that CVE in the final report, which are not actually affecting your code for known reasons.</p>
<p>My tought was quite simple, and involved the fact that vulnerabilities might be blocked by the environment the application is running on. A clear example of this, is when you run your application on a distrubuted system like Kubernetes. Kubernetes offers a nice way to define privilege and access control settings for a Pod or Container. This is possible by using the Security Context settings to harden the deployment for your application. Here&rsquo;s an example:</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#7ee787">apiVersion</span>:<span style="color:#6e7681"> </span><span style="color:#a5d6ff">apps/v1</span><span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681"></span><span style="color:#7ee787">kind</span>:<span style="color:#6e7681"> </span><span style="color:#a5d6ff">Deployment</span><span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681"></span><span style="color:#7ee787">metadata</span>:<span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">  </span><span style="color:#7ee787">name</span>:<span style="color:#6e7681"> </span><span style="color:#a5d6ff">nginx-secure</span><span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">  </span><span style="color:#7ee787">namespace</span>:<span style="color:#6e7681"> </span><span style="color:#a5d6ff">default</span><span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">  </span><span style="color:#7ee787">labels</span>:<span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">    </span><span style="color:#7ee787">app</span>:<span style="color:#6e7681"> </span><span style="color:#a5d6ff">nginx</span><span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681"></span><span style="color:#7ee787">spec</span>:<span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">  </span><span style="color:#7ee787">template</span>:<span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">    </span><span style="color:#7ee787">spec</span>:<span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">      </span><span style="color:#7ee787">containers</span>:<span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">      </span>- <span style="color:#7ee787">name</span>:<span style="color:#6e7681"> </span><span style="color:#a5d6ff">nginx</span><span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">        </span><span style="color:#7ee787">image</span>:<span style="color:#6e7681"> </span><span style="color:#a5d6ff">nginx:1.21.0</span><span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">        </span><span style="color:#7ee787">ports</span>:<span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">        </span>- <span style="color:#7ee787">containerPort</span>:<span style="color:#6e7681"> </span><span style="color:#a5d6ff">8080</span><span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">          </span><span style="color:#7ee787">name</span>:<span style="color:#6e7681"> </span><span style="color:#a5d6ff">http</span><span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">        </span><span style="color:#8b949e;font-style:italic"># container-level security context</span><span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">        </span><span style="color:#7ee787">securityContext</span>:<span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">          </span><span style="color:#7ee787">allowPrivilegeEscalation</span>:<span style="color:#6e7681"> </span><span style="color:#79c0ff">false</span><span style="color:#6e7681">
</span></span></span><span style="display:flex;"><span><span style="color:#6e7681">          </span><span style="color:#7ee787">readOnlyRootFilesystem</span>:<span style="color:#6e7681"> </span><span style="color:#79c0ff">true</span><span style="color:#6e7681">
</span></span></span></code></pre></div><p>Just by setting <code>allowPrivilegeEscalation: false</code> and <code>readOnlyRootFilesystem: true</code>, we can sensitively reduce the attack surface of our running container. This leads to the blocking of some CVEs that require a writable file system or the ability to elevate privileges in order to exploit the system.</p>
<p>So, the Security Context looks like a valuable way to protect the application against certain <strong>class</strong> of CVEs. But, are CVEs actually classified in a way we can predict which Security Context should be applied in order to block them? The answer is quite complex, but apparently we could.</p>
<p>When a new vulnerability is discovered, in order to become a CVE, it must pass through a process of confirmation by the identification of the minimum required data elements for a CVE Record. Then the record is published to the CVE List with a unique ID. Trough this process, the vulnerability is also classified into one (or more) CWEs. <a href="https://cwe.mitre.org/about/new_to_cwe.html"  class="external-link" target="_blank" rel="noopener">CWE</a> stands for Common Weakness Enumeration, and is a category system for hardware and software weaknesses and vulnerabilities.</p>
<p>Looking at this example <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-36159"  class="external-link" target="_blank" rel="noopener">CVE-2021-36159</a>, we can see it has been categorized as an &ldquo;Out-of-bounds Read&rdquo; vulnerability (<a href="https://cwe.mitre.org/data/definitions/125.html"  class="external-link" target="_blank" rel="noopener">CWE-125</a>).</p>
<p>As a next step, I had to rack my brain and map CWEs to a set of Security Context settings able to block or reduce the vulnerability impact. I&rsquo;m not going to explain each of them in dept, but I&rsquo;ll just leave a link to the code that implements this concept of <a href="https://github.com/alegrey91/vex8s/blob/main/pkg/mitigation/mitigation.go"  class="external-link" target="_blank" rel="noopener">mitigation</a> by Security Context, since this might change over time. In general, each CWE class has a set rules that must match the workload deployment configuration. If the rules match, then we can consider the CVE mitigated using the Kubernetes Security Context.</p>
<p>Let&rsquo;s take as example the mitigation rule for <a href="https://cwe.mitre.org/data/definitions/732.html"  class="external-link" target="_blank" rel="noopener">CWE-732</a> (Incorrect Permission Assignment for Critical Resource).
Suppose that a CVE with this CWE classification is found. For instance, let&rsquo;s take under considation the <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-42972"  class="external-link" target="_blank" rel="noopener">CVE-2022-42972</a>. As the description of the CVE says: <em>&ldquo;A CWE-732: Incorrect Permission Assignment for Critical Resource vulnerability exists that could cause local privilege escalation when a local attacker modifies the webroot directory.&rdquo;</em>. Having the file system and volume mounts in read-only mode we should be pretty comfortable that the vulnerability wont be exploited since there&rsquo;s no way to modify the webroot directory in read-only mode.
Consequently, the settings able to mitigate this CVE translate into something like this:</p>
<ul>
<li><code>readOnlyRootFilesystem: true</code></li>
<li><code>volumeMounts[].readOnly: true</code></li>
</ul>
<p>We can now parse the workload manifest to evaluate wheter the relevant settings are in place. If we find CVEs that are mitigated by the manifest configuration, we can add them in the VEX document to inform the scanning tool to not consider those CVEs in the final report.</p>
<h2 id="sources">
  Sources
  <a class="heading-link" href="#sources">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p><a href="https://www.aquasec.com/cloud-native-academy/vulnerability-management/vulnerability-exploitability-exchange/"  class="external-link" target="_blank" rel="noopener">https://www.aquasec.com/cloud-native-academy/vulnerability-management/vulnerability-exploitability-exchange/</a></p>

      </div>


      <footer>
        


        <div id="disqus_thread"></div>
<script>
  window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "alegrey91" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
    
    document.addEventListener('themeChanged', function (e) { 
        if (document.readyState == 'complete') {
          DISQUS.reset({ reload: true, config: disqus_config });
        }
    });
</script>
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2019 -
    
    2025
     Alessio Greggi 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
